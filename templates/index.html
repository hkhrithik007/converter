<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Media Converter</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700&display=swap");
      body {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        margin: 0;
        font-family: "Montserrat", sans-serif;
        color: #241846;
        position: relative;
        width: 100vw;
        height: 100vh;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .background-images {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        z-index: 0;
        overflow: hidden;
      }
      .card {
        background: #fff;
        padding: 2rem 2.5rem;
        border-radius: 1.25rem;
        box-shadow:
          0 10px 32px rgba(0, 0, 0, 0.17),
          0 2px 4px rgba(0, 0, 0, 0.12);
        text-align: center;
        max-width: 400px;
        width: 100%;
        position: relative;
        z-index: 2;
      }
      h2 {
        margin-bottom: 1rem;
        color: #241846;
        font-weight: 700;
        letter-spacing: 1px;
        text-shadow:
          0 2px 12px #fff,
          0 1px 0 #c2b9d6;
      }
      .tabs {
        display: flex;
        border-bottom: 2px solid #eee;
        margin-bottom: 1.5rem;
      }
      .tab {
        flex: 1;
        padding: 1rem;
        cursor: pointer;
        background: none;
        border: none;
        outline: none;
        font-size: 1.1rem;
        color: #7d59c1;
        font-weight: 600;
        border-bottom: 3px solid transparent;
        transition:
          color 0.2s,
          border-bottom 0.2s;
      }
      .tab.active {
        color: #241846;
        border-bottom: 3px solid #764ba2;
        background: #f7f6fc;
      }
      .tab-content {
        display: none;
      }
      .tab-content.active {
        display: block;
      }
      label {
        display: block;
        text-align: left;
        margin: 0.75rem 0 0.3rem 0.1rem;
        color: #37296a;
        font-weight: 600;
        text-shadow: 0 1px 8px #fff;
      }
      input[type="file"],
      select {
        width: 100%;
        padding: 0.4rem;
        border-radius: 0.4rem;
        border: 1px solid #eee;
        background: #f7f6fc;
        margin-bottom: 1rem;
        color: #21123d;
      }
      button {
        background: linear-gradient(135deg, #667eea 0%, #48296a 100%);
        color: #fff;
        padding: 0.7rem 2.5rem;
        border: none;
        border-radius: 0.6rem;
        font-weight: 700;
        font-size: 1.1rem;
        letter-spacing: 1px;
        cursor: pointer;
        box-shadow: 0 2px 6px rgba(118, 75, 162, 0.12);
        transition:
          background 0.2s,
          transform 0.2s;
        text-shadow: 0 1px 3px #48296a99;
      }
      button:hover {
        background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
        transform: translateY(-2px) scale(1.02);
      }
      @media (max-width: 430px) {
        .card {
          padding: 1.1rem 0.6rem;
        }
      }
    </style>
  </head>
  <body>
    <div class="background-images"></div>
    <div class="card">
      <h2>Media Converter</h2>
      <div class="tabs">
        <button class="tab active" data-tab="image-tab">Image Converter</button>
        <button class="tab" data-tab="video-tab">Video Converter</button>
        <button class="tab" data-tab="audio-tab">Audio Converter</button>
      </div>
      <div id="image-tab" class="tab-content active">
        <form id="image-form" enctype="multipart/form-data">
          <label for="image">Upload Image</label>
          <input type="file" name="image" accept="image/*" required />
          <label for="format">Convert to</label>
          <select name="format" required>
            <option value="png">PNG</option>
            <option value="jpg">JPG</option>
            <option value="bmp">BMP</option>
            <option value="gif">GIF</option>
            <option value="tiff">TIFF</option>
            <option value="webp">WEBP</option>
            <option value="ico">ICO</option>
          </select>
          <button type="submit">Convert</button>
        </form>
      </div>
      <div id="video-tab" class="tab-content">
        <form id="video-form" enctype="multipart/form-data">
          <label for="video">Upload Video</label>
          <input type="file" name="video" accept="video/*" required />
          <label for="video_format">Convert to</label>
          <select name="video_format" required>
            <option value="mp4">MP4</option>
            <option value="avi">AVI</option>
            <option value="mov">MOV</option>
            <option value="webm">WEBM</option>
            <option value="gif">GIF (animated)</option>
          </select>
          <button type="submit">Convert</button>
        </form>
      </div>
      <div id="audio-tab" class="tab-content">
        <form id="audio-form" enctype="multipart/form-data">
          <label for="audio">Upload Audio</label>
          <input type="file" name="audio" accept="audio/*" required />
          <label for="audio_format">Convert to</label>
          <select name="audio_format" required>
            <option value="mp3">MP3</option>
            <option value="wav">WAV</option>
            <option value="ogg">OGG</option>
            <option value="aac">AAC</option>
            <option value="flac">FLAC</option>
            <option value="wma">WMA</option>
            <option value="m4a">M4A</option>
          </select>
          <button type="submit">Convert</button>
        </form>
      </div>
    </div>
    <!-- Progress bar -->
    <div
      id="progress-bar"
      style="
        display: none;
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: #764ba2;
        color: white;
        border-radius: 10px;
        padding: 10px 30px;
        font-weight: 600;
        z-index: 99;
        transition: background 0.3s;
      "
    >
      <span id="progress-text">Converting, please wait...</span>
      <span
        id="progress-spinner"
        style="margin-left: 16px; vertical-align: middle"
      >
        <svg width="24" height="24" viewBox="0 0 38 38">
          <circle
            cx="19"
            cy="19"
            r="16"
            stroke="#fff"
            stroke-width="4"
            fill="none"
            stroke-linecap="round"
            stroke-dasharray="80"
            stroke-dashoffset="60"
          >
            <animateTransform
              attributeName="transform"
              type="rotate"
              from="0 19 19"
              to="360 19 19"
              dur="1s"
              repeatCount="indefinite"
            />
          </circle>
        </svg>
      </span>
      <span
        id="progress-tick"
        style="display: none; margin-left: 12px; vertical-align: middle"
      >
        <svg
          width="26"
          height="26"
          viewBox="0 0 24 24"
          fill="none"
          stroke="#fff"
          stroke-width="3"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <polyline points="20 6 10.8 17 4 10"></polyline>
        </svg>
      </span>
    </div>
    <script>
      // Tab UI
      document.querySelectorAll(".tab").forEach((btn) => {
        btn.addEventListener("click", function () {
          document
            .querySelectorAll(".tab")
            .forEach((b) => b.classList.remove("active"));
          document
            .querySelectorAll(".tab-content")
            .forEach((tc) => tc.classList.remove("active"));
          this.classList.add("active");
          document.getElementById(this.dataset.tab).classList.add("active");
        });
      });

      // Background images
      const urls = [
        "https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=facearea&w=400&q=80",
        "https://images.unsplash.com/photo-1519125323398-675f0ddb6308?auto=format&fit=facearea&w=400&q=80",
        "https://images.unsplash.com/photo-1438761681033-6461ffad8d80?auto=format&fit=facearea&w=400&q=80",
        "https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=facearea&w=400&q=80",
      ];
      const bg = document.querySelector(".background-images");
      function random(min, max) {
        return Math.random() * (max - min) + min;
      }
      for (let i = 0; i < 7; i++) {
        const img = document.createElement("img");
        const url = urls[Math.floor(Math.random() * urls.length)];
        img.src = url;
        img.style.position = "absolute";
        img.style.top = random(0, 60) + "vh";
        img.style.left = random(0, 80) + "vw";
        img.style.width = random(90, 160) + "px";
        img.style.opacity = 0.16 + 0.18 * Math.random();
        img.style.transform = `rotate(${random(-45, 45)}deg) scale(${random(0.75, 1.1)})`;
        img.style.filter = "blur(2px) grayscale(70%)";
        img.style.pointerEvents = "none";
        bg.appendChild(img);
      }

      // Progress bar utility functions
      function showProgress() {
        const bar = document.getElementById("progress-bar");
        bar.style.display = "";
        document.getElementById("progress-tick").style.display = "none";
        document.getElementById("progress-spinner").style.display = "";
        document.getElementById("progress-text").textContent =
          "Converting, please wait...";
        bar.style.background = "#764ba2";
      }
      function showTick() {
        document.getElementById("progress-tick").style.display = "";
        document.getElementById("progress-spinner").style.display = "none";
        document.getElementById("progress-text").textContent =
          "Conversion complete!";
        document.getElementById("progress-bar").style.background = "#2ecc71";
        setTimeout(() => {
          document.getElementById("progress-bar").style.display = "none";
          document.getElementById("progress-bar").style.background = "#764ba2";
          document.getElementById("progress-text").textContent =
            "Converting, please wait...";
        }, 2000);
      }
      function hideProgress() {
        document.getElementById("progress-bar").style.display = "none";
      }

      // AJAX for all forms
      document
        .getElementById("image-form")
        .addEventListener("submit", async function (e) {
          e.preventDefault();
          showProgress();
          const form = e.target,
            data = new FormData(form);
          try {
            const response = await fetch("/convert-image", {
              method: "POST",
              body: data,
            });
            if (!response.ok) throw new Error("Conversion failed");
            const blob = await response.blob(),
              url = URL.createObjectURL(blob);
            const a = document.createElement("a");
            a.style.display = "none";
            a.href = url;
            a.download = "converted." + form.format.value;
            document.body.appendChild(a);
            a.click();
            URL.revokeObjectURL(url);
            a.remove();
            showTick();
          } catch (err) {
            alert(err.message);
            hideProgress();
          }
        });
      document
        .getElementById("video-form")
        .addEventListener("submit", async function (e) {
          e.preventDefault();
          showProgress();
          const form = e.target,
            data = new FormData(form);
          try {
            const response = await fetch("/convert-video", {
              method: "POST",
              body: data,
            });
            if (!response.ok) throw new Error("Conversion failed");
            const blob = await response.blob(),
              url = URL.createObjectURL(blob);
            const a = document.createElement("a");
            a.style.display = "none";
            a.href = url;
            a.download = "converted." + form.video_format.value;
            document.body.appendChild(a);
            a.click();
            URL.revokeObjectURL(url);
            a.remove();
            showTick();
          } catch (err) {
            alert(err.message);
            hideProgress();
          }
        });
      document
        .getElementById("audio-form")
        .addEventListener("submit", async function (e) {
          e.preventDefault();
          showProgress();
          const form = e.target,
            data = new FormData(form);
          try {
            const response = await fetch("/convert-audio", {
              method: "POST",
              body: data,
            });
            if (!response.ok) throw new Error("Conversion failed");
            const blob = await response.blob(),
              url = URL.createObjectURL(blob);
            const a = document.createElement("a");
            a.style.display = "none";
            a.href = url;
            a.download = "converted." + form.audio_format.value;
            document.body.appendChild(a);
            a.click();
            URL.revokeObjectURL(url);
            a.remove();
            showTick();
          } catch (err) {
            alert(err.message);
            hideProgress();
          }
        });
    </script>
  </body>
</html>
